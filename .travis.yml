language: ruby
rvm:
  - 2.4.2

branches:
  only:
    - gh-pages

sudo: false
cache: bundler

# Make build error instead of fail when validator.nu is down
before_install:
  - wget -O /dev/null http://validator.nu

script:
  - bundle exec jekyll build
  - bundle exec ./validate.rb

after_success:
  - 'curl -s http://google.com/ping\?sitemap=https:%3A%2F%2Fblog.sigurdhsson.org%2Fsitemap.xml > /dev/null'
