/* mjulb v 0.0.3 | tony[at]formalibre.si | GPL3 Licensed | modified by sigurdhsson[at]gmail.com 2014-09-24 */ var $,__slice=[].slice;$=jQuery;$.fn.extend({mjulb:function(){var e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m;m=1<=arguments.length?__slice.call(arguments,0):[];l=m.scaling,h=m.transition;t=$("body");n=$(document);p=$(window);i=n.width();r=n.height();v=p.width();d=p.height();e=this.map(function(){return $(this).attr("href")});a=l!=null?l:l=.9;c=h!=null?h:h=300;s=function(e){var t,n,r;if(!e.content){e.content=""}if(!e.el){e.el="div"}t=function(){var t;t=[];for(n in e){r=e[n];if(n!=="el"&&n!=="content"){t.push(""+n+"='"+r+"'")}else{t.push(void 0)}}return t}();if(e.el!=="img"){return"<"+e.el+" "+t.join(" ")+">"+e.content+"</"+e.el+">"}else{return"<"+e.el+" "+t.join(" ")+"/>"}};o=s({el:"div",id:"modal",content:[s({el:"div",id:"blind",style:"width:"+i+"px; height:"+r+"px"}),[s({el:"div","class":"content",content:[s({el:"a",id:"rw"}),s({el:"a",id:"fw"})].join("")}),s({el:"img"})].join("")].join("")});f=function(e){var t,n,r,i,s;s=v/d;t=e.width/e.height;if(e.width>v||e.height>d){r=v*a;n=d*a;if(s>1){r=n*t}else{n=r/t}}else{r=e.width;n=e.height}return i={top:(d-n)/2+p.scrollTop(),left:(v-r)/2,width:r,height:n}};this.on("click",function(e){e.preventDefault();t.append(o);$("#modal").fadeIn();return u($(this).attr("href"))});n.on("click","#modal #fw, #modal #rw",function(e){e.preventDefault();return u($(this).attr("href"))});n.on("click","#modal",function(e){if(e.target.id!=="fw"&&e.target.id!=="rw"){return $(this).fadeOut("slow",function(){return $(this).remove()})}});u=function(t){var n,r,i,o,u,a,l,h,p;o=(h=e[a=$.inArray(t,e)-1])!=null?h:e[a]=e[e.length-1];n=(p=e[l=$.inArray(t,e)+1])!=null?p:e[l]=e[0];$("#modal #fw").attr({href:n});$("#modal #rw").attr({href:o});r=$("#modal .content");i=$("#modal .temp");u=s({el:"div","class":"temp"});return $("<img/>").attr({src:t}).load(function(){var e,n;n=f(this);e={position:"absolute",display:"none",left:n.left,top:n.top,width:n.width,height:n.height,"background-image":"url('"+t+"')","background-size":"100%","z-index":1};if(r.attr("style")){$(u).insertBefore(r);i.attr({style:r.attr("style")})}r.css(e).fadeIn(c,function(){return i.fadeOut(c,function(){return $(this).remove()})});return $("#modal img").css({display:"none"}).attr({src:t})})};return true}})
